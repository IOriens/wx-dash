<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>多线程</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="wxcreateworkerscriptpath">wx.createWorker(scriptPath)</h3>
<blockquote>
<p>基础库 1.9.90 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>在使用 createWorker 前，请查阅 <a href="../framework/workers.html">多线程</a> 文档了解基础知识和配置方法。</p>
<p>创建一个 Worker 线程，并返回 Worker 实例，目前限制最多只能创建一个 Worker，创建下一个 Worker 前请调用 Worker.terminate。</p>
<p><code>scriptPath</code> 为 worker 的入口文件路径，需填写绝对路径。</p>
<h4 id="worker">Worker</h4>
<p><strong>Worker 对象的方法列表：</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>postMessage</td>
<td>Object</td>
<td>向 Worker 线程发送的消息。</td>
</tr>
<tr>
<td>onMessage</td>
<td>callback</td>
<td>监听 Worker 线程向当前线程发送的消息</td>
</tr>
<tr>
<td>terminate</td>
<td></td>
<td>结束当前 Worker 线程，仅限在主线程 Worker 实例上调用。</td>
</tr>
</tbody>
</table>
<p><strong>postMessage(message) 说明：</strong></p>
<p>向 Worker 线程发送消息，<code>message</code> 参数为需要发送的消息，必须是一个可序列化的 JavaScript 对象。</p>
<p><strong>onMessage(callback) 回调结果说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td>Object</td>
<td>Worker 线程向当前线程发送的消息</td>
</tr>
</tbody>
</table>
<p><strong>terminate() 说明：</strong></p>
<p>结束当前 worker 线程，仅限在主线程 Worker 对象上调用。</p>
<p><strong>示例代码：</strong></p>
<p>运行以下代码需先进行基础配置，详细请查阅 <a href="../framework/workers.html">多线程</a> 文档了解基础知识和配置方法。</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> worker = wx.createWorker(<span class="hljs-string">'workers/request/index.js'</span>) <span class="hljs-comment">// 文件名指定 worker 的入口文件路径，绝对路径</span>

worker.onMessage(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
  <span class="hljs-built_in">console</span>.log(res)
})

worker.postMessage({
  msg: <span class="hljs-string">'hello worker'</span>
})

worker.terminate()
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
