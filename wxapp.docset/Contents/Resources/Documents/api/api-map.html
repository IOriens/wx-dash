<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>地图组件控制</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="wxcreatemapcontextmapid-this">wx.createMapContext(mapId, this)</h3>
<p>创建并返回 map 上下文 <code>mapContext</code> 对象。在自定义组件下，第二个参数传入组件实例this，以操作组件内 <code><map/></code> 组件</p>
<h4 id="mapcontext">mapContext</h4>
<p><code>mapContext</code> 通过 mapId 跟一个 <code><map/></code> 组件绑定，通过它可以操作对应的 <code><map/></code> 组件。</p>
<p><strong>mapContext 对象的方法列表</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
<th>最低版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>getCenterLocation</td>
<td>OBJECT</td>
<td>获取当前地图中心的经纬度，返回的是 gcj02 坐标系，可以用于 <a href="location.html#wxopenlocationobject"><code>wx.openLocation</code></a></td>
<td></td>
</tr>
<tr>
<td>moveToLocation</td>
<td>无</td>
<td>将地图中心移动到当前定位点，需要配合map组件的show-location使用</td>
<td></td>
</tr>
<tr>
<td>translateMarker</td>
<td>OBJECT</td>
<td>平移marker，带动画</td>
<td><a href="../framework/compatibility.html" title="基础库 1.2.0 开始支持，低版本需做兼容处理。">1.2.0</a></td>
</tr>
<tr>
<td>includePoints</td>
<td>OBJECT</td>
<td>缩放视野展示所有经纬度</td>
<td><a href="../framework/compatibility.html" title="基础库 1.2.0 开始支持，低版本需做兼容处理。">1.2.0</a></td>
</tr>
<tr>
<td>getRegion</td>
<td>OBJECT</td>
<td>获取当前地图的视野范围</td>
<td><a href="../framework/compatibility.html" title="基础库 1.4.0 开始支持，低版本需做兼容处理。">1.4.0</a></td>
</tr>
<tr>
<td>getScale</td>
<td>OBJECT</td>
<td>获取当前地图的缩放级别</td>
<td><a href="../framework/compatibility.html" title="基础库 1.4.0 开始支持，低版本需做兼容处理。">1.4.0</a></td>
</tr>
</tbody>
</table>
<p><strong>getCenterLocation 的 OBJECT 参数列表</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数 ，res = { longitude: "经度", latitude: "纬度"}</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>translateMarker 的 OBJECT 参数列表</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>markerId</td>
<td>Number</td>
<td>是</td>
<td>指定marker</td>
</tr>
<tr>
<td>destination</td>
<td>Object</td>
<td>是</td>
<td>指定marker移动到的目标点</td>
</tr>
<tr>
<td>autoRotate</td>
<td>Boolean</td>
<td>是</td>
<td>移动过程中是否自动旋转marker</td>
</tr>
<tr>
<td>rotate</td>
<td>Number</td>
<td>是</td>
<td>marker的旋转角度</td>
</tr>
<tr>
<td>duration</td>
<td>Number</td>
<td>否</td>
<td>动画持续时长，默认值1000ms，平移与旋转分别计算</td>
</tr>
<tr>
<td>animationEnd</td>
<td>Function</td>
<td>否</td>
<td>动画结束回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
</tbody>
</table>
<p><strong>includePoints 的 OBJECT 参数列表</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>points</td>
<td>Array</td>
<td>是</td>
<td>要显示在可视区域内的坐标点列表，[{latitude, longitude}]</td>
</tr>
<tr>
<td>padding</td>
<td>Array</td>
<td>否</td>
<td>坐标点形成的矩形边缘到地图边缘的距离，单位像素。格式为[上,右,下,左]，安卓上只能识别数组第一项，上下左右的padding一致。开发者工具暂不支持padding参数。</td>
</tr>
</tbody>
</table>
<p><strong>getRegion 的 OBJECT 参数列表</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数，res = {southwest, northeast}，西南角与东北角的经纬度</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>getScale 的 OBJECT 参数列表</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数，res = {scale}</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<p><a href="wechatide://minicode/3uVxpmmT6wY9" target="_blank">在开发者工具中预览效果</a></p>
<pre><code class="lang-html"><span class="hljs-comment"><!-- map.wxml --></span>
<span class="hljs-tag"><<span class="hljs-name">map</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myMap"</span> <span class="hljs-attr">show-location</span> /></span>

<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"getCenterLocation"</span>></span>获取位置<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"moveToLocation"</span>></span>移动位置<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"translateMarker"</span>></span>移动标注<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"includePoints"</span>></span>缩放视野展示所有经纬度<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
</code></pre>
<pre><code class="lang-javascript"><span class="hljs-comment">// map.js</span>
Page({
  onReady: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-comment">// 使用 wx.createMapContext 获取 map 上下文</span>
    <span class="hljs-keyword">this</span>.mapCtx = wx.createMapContext(<span class="hljs-string">'myMap'</span>)
  },
  getCenterLocation: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.mapCtx.getCenterLocation({
      success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>)</span>{
        <span class="hljs-built_in">console</span>.log(res.longitude)
        <span class="hljs-built_in">console</span>.log(res.latitude)
      }
    })
  },
  moveToLocation: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.mapCtx.moveToLocation()
  },
  translateMarker: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.mapCtx.translateMarker({
      markerId: <span class="hljs-number">0</span>,
      autoRotate: <span class="hljs-literal">true</span>,
      duration: <span class="hljs-number">1000</span>,
      destination: {
        latitude:<span class="hljs-number">23.10229</span>,
        longitude:<span class="hljs-number">113.3345211</span>,
      },
      animationEnd() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'animation end'</span>)
      }
    })
  },
  includePoints: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.mapCtx.includePoints({
      padding: [<span class="hljs-number">10</span>],
      points: [{
        latitude:<span class="hljs-number">23.10229</span>,
        longitude:<span class="hljs-number">113.3345211</span>,
      }, {
        latitude:<span class="hljs-number">23.00229</span>,
        longitude:<span class="hljs-number">113.3345211</span>,
      }]
    })
  }
})
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
