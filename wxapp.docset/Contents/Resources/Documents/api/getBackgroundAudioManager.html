<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>背景音频播放管理</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="wxgetbackgroundaudiomanager">wx.getBackgroundAudioManager()</h3>
<blockquote>
<p>基础库 1.2.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>获取<strong>全局唯一</strong>的背景音频管理器 <code>backgroundAudioManager</code>。</p>
<h4 id="backgroundaudiomanager">backgroundAudioManager</h4>
<p><strong>backgroundAudioManager 对象的属性列表：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
<th>只读</th>
</tr>
</thead>
<tbody>
<tr>
<td>duration</td>
<td>Number</td>
<td>当前音频的长度（单位：s），只有在当前有合法的 src 时返回</td>
<td>是</td>
</tr>
<tr>
<td>currentTime</td>
<td>Number</td>
<td>当前音频的播放位置（单位：s），只有在当前有合法的 src 时返回</td>
<td>是</td>
</tr>
<tr>
<td>paused</td>
<td>Boolean</td>
<td>当前是是否暂停或停止状态，true 表示暂停或停止，false 表示正在播放</td>
<td>是</td>
</tr>
<tr>
<td>src</td>
<td>String</td>
<td>音频的数据源，默认为空字符串，<strong>当设置了新的 src 时，会自动开始播放</strong> ，目前支持的格式有 m4a, aac, mp3, wav</td>
<td>否</td>
</tr>
<tr>
<td>startTime</td>
<td>Number</td>
<td>音频开始播放的位置（单位：s）</td>
<td>否</td>
</tr>
<tr>
<td>buffered</td>
<td>Number</td>
<td>音频缓冲的时间点，仅保证当前播放时间点到此时间点内容已缓冲。</td>
<td>是</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>音频标题，用于做原生音频播放器音频标题。原生音频播放器中的分享功能，分享出去的卡片标题，也将使用该值。</td>
<td>否</td>
</tr>
<tr>
<td>epname</td>
<td>String</td>
<td>专辑名，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。</td>
<td>否</td>
</tr>
<tr>
<td>singer</td>
<td>String</td>
<td>歌手名，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。</td>
<td>否</td>
</tr>
<tr>
<td>coverImgUrl</td>
<td>String</td>
<td>封面图url，用于做原生音频播放器背景图。原生音频播放器中的分享功能，分享出去的卡片配图及背景也将使用该图。</td>
<td>否</td>
</tr>
<tr>
<td>webUrl</td>
<td>String</td>
<td>页面链接，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。</td>
<td>否</td>
</tr>
</tbody>
</table>
<p><strong>backgroundAudioManager 对象的方法列表：</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>play</td>
<td></td>
<td>播放</td>
</tr>
<tr>
<td>pause</td>
<td></td>
<td>暂停</td>
</tr>
<tr>
<td>stop</td>
<td></td>
<td>停止</td>
</tr>
<tr>
<td>seek</td>
<td>position</td>
<td>跳转到指定位置，单位 s</td>
</tr>
<tr>
<td>onCanplay</td>
<td>callback</td>
<td>背景音频进入可以播放状态，但不保证后面可以流畅播放</td>
</tr>
<tr>
<td>onPlay</td>
<td>callback</td>
<td>背景音频播放事件</td>
</tr>
<tr>
<td>onPause</td>
<td>callback</td>
<td>背景音频暂停事件</td>
</tr>
<tr>
<td>onStop</td>
<td>callback</td>
<td>背景音频停止事件</td>
</tr>
<tr>
<td>onEnded</td>
<td>callback</td>
<td>背景音频自然播放结束事件</td>
</tr>
<tr>
<td>onTimeUpdate</td>
<td>callback</td>
<td>背景音频播放进度更新事件</td>
</tr>
<tr>
<td>onPrev</td>
<td>callback</td>
<td>用户在系统音乐播放面板点击上一曲事件（iOS only）</td>
</tr>
<tr>
<td>onNext</td>
<td>callback</td>
<td>用户在系统音乐播放面板点击下一曲事件（iOS only）</td>
</tr>
<tr>
<td>onError</td>
<td>callback</td>
<td>背景音频播放错误事件</td>
</tr>
<tr>
<td>onWaiting</td>
<td>callback</td>
<td>音频加载中事件，当音频因为数据不足，需要停下来加载时会触发</td>
</tr>
</tbody>
</table>
<h4 id="errcode-说明">errcode 说明</h4>
<table>
<thead>
<tr>
<th>errCode</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>10001</td>
<td>系统错误</td>
</tr>
<tr>
<td>10002</td>
<td>网络错误</td>
</tr>
<tr>
<td>10003</td>
<td>文件错误</td>
</tr>
<tr>
<td>10004</td>
<td>格式错误</td>
</tr>
<tr>
<td>-1</td>
<td>未知错误</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> backgroundAudioManager = wx.getBackgroundAudioManager()

backgroundAudioManager.title = <span class="hljs-string">'此时此刻'</span>
backgroundAudioManager.epname = <span class="hljs-string">'此时此刻'</span>
backgroundAudioManager.singer = <span class="hljs-string">'许巍'</span>
backgroundAudioManager.coverImgUrl = <span class="hljs-string">'http://y.gtimg.cn/music/photo_new/T002R300x300M000003rsKF44GyaSk.jpg?max_age=2592000'</span>
backgroundAudioManager.src = <span class="hljs-string">'http://ws.stream.qqmusic.qq.com/M500001VfvsJ21xFqb.mp3?guid=ffffffff82def4af4b12b3cd9337d5e7&uin=346897220&vkey=6292F51E1E384E061FF02C31F716658E5C81F5594D561F2E88B854E81CAAB7806D5E4F103E55D33C16F3FAC506D1AB172DE8600B37E43FAD&fromtag=46'</span> <span class="hljs-comment">// 设置了 src 之后会自动播放</span>
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
