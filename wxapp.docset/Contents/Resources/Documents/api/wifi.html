<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Wi-Fi</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>在小程序中支持搜索周边的 Wi-Fi，同时可以针对指定 Wi-Fi，传入密码发起连接。</p>
<p>该系列接口为系统原生能力，如需查看“微信连Wi-Fi”能力及配置跳转小程序，请参考<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&id=215135855720FBA0" target="_blank">文档</a>。</p>
<p>连接指定 Wi-Fi 接口调用时序：  </p>
<ul>
<li>Android：
startWifi —> connectWifi —> onWifiConnected</li>
<li>iOS（仅iOS 11及以上版本支持）：<br>startWifi —> connectWifi —> onWifiConnected  </li>
</ul>
<p>连周边 Wi-Fi 接口调用时序：  </p>
<ul>
<li>Android
startWifi —> getWifiList —> onGetWifiList —> connectWifi —> onWifiConnected  </li>
<li>iOS（iOS 11.0及11.1版本因系统原因暂不支持）：<br>startWifi —> getWifiList —> onGetWifiList —> setWifiList —> onWifiConnected</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>Wi-Fi 相关接口暂不可用 <code>wx.canIUse</code> 接口判断。</li>
<li>Android 6.0 以上版本，在没有打开定位开关的时候会导致设备不能正常获取周边的 Wi-Fi 信息。</li>
</ul>
<h3 id="wxstartwifiobject">wx.startWifi(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>初始化 Wi-Fi 模块。</p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript">wx.startWifi({
  success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
    <span class="hljs-built_in">console</span>.log(res.errMsg)
  }
})
</code></pre>
<h3 id="wxstopwifiobject">wx.stopWifi(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>关闭 Wi-Fi 模块。</p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript">wx.stopWifi({
  success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
    <span class="hljs-built_in">console</span>.log(res.errMsg)
  }
})
</code></pre>
<h3 id="wxconnectwifiobject">wx.connectWifi(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>连接 Wi-Fi。若已知 Wi-Fi 信息，可以直接利用该接口连接。仅 Android 与 iOS 11 以上版本支持。</p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSID</td>
<td>String</td>
<td>是</td>
<td>Wi-Fi 设备ssid</td>
</tr>
<tr>
<td>BSSID</td>
<td>String</td>
<td>是</td>
<td>Wi-Fi 设备bssid</td>
</tr>
<tr>
<td>password</td>
<td>String</td>
<td>否</td>
<td>Wi-Fi 设备密码</td>
</tr>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript">wx.connectWifi({
  SSID: <span class="hljs-string">''</span>,
  BSSID: <span class="hljs-string">''</span>,
  success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
    <span class="hljs-built_in">console</span>.log(res.errMsg)
  }
})
</code></pre>
<h3 id="wxgetwifilistobject">wx.getWifiList(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>请求获取 Wi-Fi 列表，在 <code>onGetWifiList</code> 注册的回调中返回 wifiList 数据。iOS 将跳转到系统的 Wi-Fi 界面，Android 不会跳转。
<strong>iOS 11.0 及 iOS 11.1 两个版本因系统问题，该方法失效。但在 iOS 11.2 中已修复。</strong></p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<h3 id="wxongetwifilistcallback">wx.onGetWifiList(CALLBACK)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>监听在获取到 Wi-Fi 列表数据时的事件，在回调中将返回 wifiList。</p>
<p><strong>CALLBACK 返回参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wifiList</td>
<td>Array</td>
<td>Wi-Fi 列表数据</td>
</tr>
</tbody>
</table>
<p><strong>Wi-Fi 列表项说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSID</td>
<td>String</td>
<td>Wi-Fi 的SSID</td>
</tr>
<tr>
<td>BSSID</td>
<td>String</td>
<td>Wi-Fi 的BSSID</td>
</tr>
<tr>
<td>secure</td>
<td>Boolean</td>
<td>Wi-Fi 是否安全</td>
</tr>
<tr>
<td>signalStrength</td>
<td>Number</td>
<td>Wi-Fi 信号强度</td>
</tr>
</tbody>
</table>
<h3 id="wxsetwifilistobject">wx.setWifiList(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p><strong>iOS特有接口</strong>
在 <code>onGetWifiList</code> 回调后，利用接口设置 wifiList 中 AP 的相关信息。</p>
<p>注意：</p>
<ol>
<li>该接口只能在 <code>onGetWifiList</code> 回调之后才能调用。</li>
<li>此时客户端会挂起，等待小程序设置 Wi-Fi 信息，请务必尽快调用该接口，若无数据请传入一个空数组。</li>
<li>有可能随着周边 Wi-Fi 列表的刷新，单个流程内收到多次带有存在重复的 Wi-Fi 列表的回调。</li>
</ol>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wifiList</td>
<td>Array</td>
<td>是</td>
<td>提供预设的 Wi-Fi 信息列表</td>
</tr>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>Wi-Fi 信息列表项说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSID</td>
<td>String</td>
<td>Wi-Fi 设备ssid</td>
</tr>
<tr>
<td>BSSID</td>
<td>String</td>
<td>Wi-Fi 设备bssid</td>
</tr>
<tr>
<td>password</td>
<td>String</td>
<td>Wi-Fi 设备密码</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript">wx.onGetWifiList(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>{
  <span class="hljs-keyword">if</span> (res.wifiList.length) {
    wx.setWifiList({
      wifiList: [{
        SSID: res.wifiList[<span class="hljs-number">0</span>].SSID,
        BSSID: res.wifiList[<span class="hljs-number">0</span>].BSSID,
        password: <span class="hljs-string">'123456'</span>
      }]
    })
  } <span class="hljs-keyword">else</span> {
    wx.setWifiList({
      wifiList: []
    })
  }
})
wx.getWifiList()
</code></pre>
<h3 id="wxonwificonnectedcallback">wx.onWifiConnected(CALLBACK)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>监听连接上 Wi-Fi 的事件。</p>
<p><strong>CALLBACK 返回参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wifi</td>
<td>Object</td>
<td>Wi-Fi 信息</td>
</tr>
</tbody>
</table>
<p><strong>wifi对象说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSID</td>
<td>String</td>
<td>Wi-Fi 的SSID</td>
</tr>
<tr>
<td>BSSID</td>
<td>String</td>
<td>Wi-Fi 的BSSID</td>
</tr>
<tr>
<td>secure</td>
<td>Boolean</td>
<td>Wi-Fi 是否安全</td>
</tr>
<tr>
<td>signalStrength</td>
<td>Number</td>
<td>Wi-Fi 信号强度</td>
</tr>
</tbody>
</table>
<!--
### wx.onEvaluateWifi(CALLBACK)
> 基础库 1.7.0 开始支持，低版本需做[兼容处理](/framework/compatibility.md)


监听需要评估连上的 Wi-Fi 的请求，在回调里必须返回 `confidence` 字段

**CALLBACK 返回参数说明：**

| 参数            | 类型        | 说明                            |
|-----------------|-------------|---------------------------------|
| wifi            | Object      | Wi-Fi 信息                       |

**wifi对象说明：**

| 参数            | 类型        | 说明                            |
|-----------------|-------------|---------------------------------|
| SSID            | String      | Wi-Fi 的SSID                     |
| BSSID           | String      | Wi-Fi 的BSSID                    |
| secure          | Boolean     | Wi-Fi 是否安全                   |
| signalStrength  | Number      | Wi-Fi 信号强度                   |

**confidence 说明：**
| 值   | 说明                   |
| ---- | ---------------------- |
| none | 无需打开网页登录       |
| low  | 一次性需要打开网页登录 |
| high | 每次都需要打开网页登录 |
-->
<h3 id="wxgetconnectedwifiobject">wx.getConnectedWifi(OBJECT)</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>获取已连接中的 Wi-Fi 信息</p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>Function</td>
<td>否</td>
<td>接口调用成功的回调函数</td>
</tr>
<tr>
<td>fail</td>
<td>Function</td>
<td>否</td>
<td>接口调用失败的回调函数</td>
</tr>
<tr>
<td>complete</td>
<td>Function</td>
<td>否</td>
<td>接口调用结束的回调函数（调用成功、失败都会执行）</td>
</tr>
</tbody>
</table>
<p><strong>success返回参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wifi</td>
<td>Object</td>
<td>Wi-Fi 信息</td>
</tr>
</tbody>
</table>
<p><strong>wifi对象说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SSID</td>
<td>String</td>
<td>Wi-Fi 的SSID</td>
</tr>
<tr>
<td>BSSID</td>
<td>String</td>
<td>Wi-Fi 的BSSID</td>
</tr>
<tr>
<td>secure</td>
<td>Boolean</td>
<td>Wi-Fi 是否安全</td>
</tr>
<tr>
<td>signalStrength</td>
<td>Number</td>
<td>Wi-Fi 信号强度</td>
</tr>
</tbody>
</table>
<h4 id="errcode列表">errCode列表</h4>
<p>每个接口调用的时候，都会返回 <code>errCode</code> 字段。</p>
<table>
<thead>
<tr>
<th>错误码</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>ok</td>
<td>正常</td>
</tr>
<tr>
<td>12000</td>
<td>not init</td>
<td>未先调用startWifi接口</td>
</tr>
<tr>
<td>12001</td>
<td>system not support</td>
<td>当前系统不支持相关能力</td>
</tr>
<tr>
<td>12002</td>
<td>password error</td>
<td>Wi-Fi 密码错误</td>
</tr>
<tr>
<td>12003</td>
<td>connection timeout</td>
<td>连接超时</td>
</tr>
<tr>
<td>12004</td>
<td>duplicate request</td>
<td>重复连接 Wi-Fi</td>
</tr>
<tr>
<td>12005</td>
<td>wifi not turned on</td>
<td>Android特有，未打开 Wi-Fi 开关</td>
</tr>
<tr>
<td>12006</td>
<td>gps not turned on</td>
<td>Android特有，未打开 GPS 定位开关</td>
</tr>
<tr>
<td>12007</td>
<td>user denied</td>
<td>用户拒绝授权链接 Wi-Fi</td>
</tr>
<tr>
<td>12008</td>
<td>invalid SSID</td>
<td>无效SSID</td>
</tr>
<tr>
<td>12009</td>
<td>system config err</td>
<td>系统运营商配置拒绝连接 Wi-Fi</td>
</tr>
<tr>
<td>12010</td>
<td>system internal error</td>
<td>系统其他错误，需要在errmsg打印具体的错误原因</td>
</tr>
<tr>
<td>12011</td>
<td>weapp in background</td>
<td>应用在后台无法配置 Wi-Fi</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
