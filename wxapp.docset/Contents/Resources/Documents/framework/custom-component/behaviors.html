<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>behaviors</title>
  <link rel="stylesheet" href="../../style.css" />
  <link rel="stylesheet" href="../../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="behaviors">behaviors</h1>
<h2 id="定义和使用-behaviors">定义和使用 behaviors</h2>
<p><code>behaviors</code> 是用于组件间代码共享的特性，类似于一些编程语言中的“mixins”或“traits”。</p>
<p>每个 <code>behavior</code> 可以包含一组属性、数据、生命周期函数和方法，组件引用它时，它的属性、数据和方法会被合并到组件中，生命周期函数也会在对应时机被调用。每个组件可以引用多个 <code>behavior</code> 。 <code>behavior</code> 也可以引用其他 <code>behavior</code> 。</p>
<p><code>behavior</code> 需要使用 <code>Behavior()</code> 构造器定义。</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-js"><span class="hljs-comment">// my-behavior.js</span>
<span class="hljs-built_in">module</span>.exports = Behavior({
  behaviors: [],
  properties: {
    myBehaviorProperty: {
      type: <span class="hljs-built_in">String</span>
    }
  },
  data: {
    myBehaviorData: {}
  },
  attached: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{},
  methods: {
    myBehaviorMethod: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{}
  }
})
</code></pre>
<p>组件引用时，在 <code>behaviors</code> 定义段中将它们逐个列出即可。</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-js"><span class="hljs-comment">// my-component.js</span>
<span class="hljs-keyword">var</span> myBehavior = <span class="hljs-built_in">require</span>(<span class="hljs-string">'my-behavior'</span>)
Component({
  behaviors: [myBehavior],
  properties: {
    myProperty: {
      type: <span class="hljs-built_in">String</span>
    }
  },
  data: {
    myData: {}
  },
  attached: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{},
  methods: {
    myMethod: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{}
  }
})
</code></pre>
<p>在上例中， <code>my-component</code> 组件定义中加入了 <code>my-behavior</code> ，而 <code>my-behavior</code> 中包含有 <code>myBehaviorProperty</code> 属性、 <code>myBehaviorData</code> 数据字段、 <code>myBehaviorMethod</code> 方法和一个 <code>attached</code> 生命周期函数。这将使得 <code>my-component</code> 中最终包含 <code>myBehaviorProperty</code> 、 <code>myProperty</code> 两个属性， <code>myBehaviorData</code> 、 <code>myData</code> 两个数据字段，和 <code>myBehaviorMethod</code> 、 <code>myMethod</code> 两个方法。当组件触发 <code>attached</code> 生命周期时，会依次触发 <code>my-behavior</code> 中的 <code>attached</code> 生命周期函数和 <code>my-component</code> 中的 <code>attached</code> 生命周期函数。</p>
<h2 id="字段的覆盖和组合规则">字段的覆盖和组合规则</h2>
<p>组件和它引用的 <code>behavior</code> 中可以包含同名的字段，对这些字段的处理方法如下：</p>
<ul>
<li>如果有同名的属性或方法，组件本身的属性或方法会覆盖 <code>behavior</code> 中的属性或方法，如果引用了多个 <code>behavior</code> ，在定义段中靠后 <code>behavior</code> 中的属性或方法会覆盖靠前的属性或方法；</li>
<li>如果有同名的数据字段，如果数据是对象类型，会进行对象合并，如果是非对象类型则会进行相互覆盖；</li>
<li>生命周期函数不会相互覆盖，而是在对应触发时机被逐个调用。如果同一个 <code>behavior</code> 被一个组件多次引用，它定义的生命周期函数只会被执行一次。</li>
</ul>
<h2 id="内置-behaviors">内置 behaviors</h2>
<p>自定义组件可以通过引用内置的 <code>behavior</code> 来获得内置组件的一些行为。</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-js">Component({
  behaviors: [<span class="hljs-string">'wx://form-field'</span>]
})
</code></pre>
<p>在上例中， <code>wx://form-field</code> 代表一个内置 <code>behavior</code> ，它使得这个自定义组件有类似于表单控件的行为。</p>
<p>内置 <code>behavior</code> 往往会为组件添加一些属性。在没有特殊说明时，组件可以覆盖这些属性来改变它的 <code>type</code> 或添加 <code>observer</code> 。</p>
<h3 id="wxform-field">wx://form-field</h3>
<p>使自定义组件有类似于表单控件的行为。 form 组件可以识别这些自定义组件，并在 submit 事件中返回组件的字段名及其对应字段值。这将为它添加以下两个属性。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
<th>最低版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>在表单中的字段名</td>
<td><a href="../compatibility.html" title="基础库 1.6.7 开始支持，低版本需做兼容处理。">1.6.7</a></td>
</tr>
<tr>
<td>value</td>
<td>任意</td>
<td>在表单中的字段值</td>
<td><a href="../compatibility.html" title="基础库 1.6.7 开始支持，低版本需做兼容处理。">1.6.7</a></td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
