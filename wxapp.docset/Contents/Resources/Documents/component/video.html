<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="UTF-8">
  <title>video</title>
  <link rel="stylesheet" href="../../../../../style.css">
  <link rel="stylesheet" href="../../../../../website.css">
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
   <div id="docContent"><div class="content custom"><h1 id="video"><a href="#video" aria-hidden="true" class="header-anchor">#</a> video</h1> <blockquote><p>基础库 1.0.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a>。</p></blockquote> <p>视频（v2.4.0 起支持<a href="native-component.html#%E5%8E%9F%E7%94%9F%E7%BB%84%E4%BB%B6%E5%90%8C%E5%B1%82%E6%B8%B2%E6%9F%93">同层渲染</a>）。相关api：<a href="../api/media/video/wx.createVideoContext.html">wx.createVideoContext</a></p> <div class="table-wrp"><table><thead><tr><th>属性</th> <th>类型</th> <th>默认值</th> <th>必填</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>src</td> <td>string</td> <td></td> <td>是</td> <td>要播放视频的资源地址，支持网络路径、本地临时路径、云文件ID（<a href="../framework/compatibility.html">2.3.0</a>）</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>duration</td> <td>number</td> <td></td> <td>否</td> <td>指定视频时长</td> <td><a href="../framework/compatibility.html">1.1.0</a></td></tr> <tr><td>controls</td> <td>boolean</td> <td>true</td> <td>否</td> <td>是否显示默认播放控件（播放/暂停按钮、播放进度、时间）</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>danmu-list</td> <td>Array.&lt;object&gt;</td> <td></td> <td>否</td> <td>弹幕列表</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>danmu-btn</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否显示弹幕按钮，只在初始化时有效，不能动态变更</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>enable-danmu</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否展示弹幕，只在初始化时有效，不能动态变更</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>autoplay</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否自动播放</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>loop</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否循环播放</td> <td><a href="../framework/compatibility.html">1.4.0</a></td></tr> <tr><td>muted</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否静音播放</td> <td><a href="../framework/compatibility.html">1.4.0</a></td></tr> <tr><td>initial-time</td> <td>number</td> <td>0</td> <td>否</td> <td>指定视频初始播放位置</td> <td><a href="../framework/compatibility.html">1.6.0</a></td></tr> <tr><td>page-gesture</td> <td>boolean</td> <td>false</td> <td>否</td> <td>在非全屏模式下，是否开启亮度与音量调节手势（废弃，见 vslide-gesture）</td> <td><a href="../framework/compatibility.html">1.6.0</a></td></tr> <tr><td>direction</td> <td>number</td> <td></td> <td>否</td> <td>设置全屏时视频的方向，不指定则根据宽高比自动判断</td> <td><a href="../framework/compatibility.html">1.7.0</a></td></tr> <tr><td>show-progress</td> <td>boolean</td> <td>true</td> <td>否</td> <td>若不设置，宽度大于240时才会显示</td> <td><a href="../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>show-fullscreen-btn</td> <td>boolean</td> <td>true</td> <td>否</td> <td>是否显示全屏按钮</td> <td><a href="../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>show-play-btn</td> <td>boolean</td> <td>true</td> <td>否</td> <td>是否显示视频底部控制栏的播放按钮</td> <td><a href="../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>show-center-play-btn</td> <td>boolean</td> <td>true</td> <td>否</td> <td>是否显示视频中间的播放按钮</td> <td><a href="../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>enable-progress-gesture</td> <td>boolean</td> <td>true</td> <td>否</td> <td>是否开启控制进度的手势</td> <td><a href="../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>object-fit</td> <td>string</td> <td>contain</td> <td>否</td> <td>当视频大小与 video 容器大小不一致时，视频的表现形式</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>poster</td> <td>string</td> <td></td> <td>否</td> <td>视频封面的图片网络资源地址或云文件ID（<a href="../framework/compatibility.html">2.3.0</a>）。若 controls 属性值为 false 则设置 poster 无效</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>show-mute-btn</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否显示静音按钮</td> <td><a href="../framework/compatibility.html">2.4.0</a></td></tr> <tr><td>title</td> <td>string</td> <td></td> <td>否</td> <td>视频的标题，全屏时在顶部展示</td> <td><a href="../framework/compatibility.html">2.4.0</a></td></tr> <tr><td>play-btn-position</td> <td>string</td> <td>bottom</td> <td>否</td> <td>播放按钮的位置</td> <td><a href="../framework/compatibility.html">2.4.0</a></td></tr> <tr><td>enable-play-gesture</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否开启播放手势，即双击切换播放/暂停</td> <td><a href="../framework/compatibility.html">2.4.0</a></td></tr> <tr><td>auto-pause-if-navigate</td> <td>boolean</td> <td>true</td> <td>否</td> <td>当跳转到本小程序的其他页面时，是否自动暂停本页面的视频播放</td> <td><a href="../framework/compatibility.html">2.5.0</a></td></tr> <tr><td>auto-pause-if-open-native</td> <td>boolean</td> <td>true</td> <td>否</td> <td>当跳转到其它微信原生页面时，是否自动暂停本页面的视频</td> <td><a href="../framework/compatibility.html">2.5.0</a></td></tr> <tr><td>vslide-gesture</td> <td>boolean</td> <td>false</td> <td>否</td> <td>在非全屏模式下，是否开启亮度与音量调节手势（同 page-gesture）</td> <td><a href="../framework/compatibility.html">2.6.2</a></td></tr> <tr><td>vslide-gesture-in-fullscreen</td> <td>boolean</td> <td>true</td> <td>否</td> <td>在全屏模式下，是否开启亮度与音量调节手势</td> <td><a href="../framework/compatibility.html">2.6.2</a></td></tr> <tr><td>ad-unit-id</td> <td>string</td> <td></td> <td>是</td> <td>视频前贴广告单元ID，更多详情可参考开放能力<a href="../framework/open-ability/ad/video-patch-ad.html">视频前贴广告</a></td> <td><a href="../framework/compatibility.html">2.8.1</a></td></tr> <tr><td>poster-for-crawler</td> <td>string</td> <td></td> <td>是</td> <td>用于给搜索等场景作为视频封面展示，建议使用无播放 icon 的视频封面图，只支持网络地址</td> <td></td></tr> <tr><td>show-casting-button</td> <td>boolean</td> <td>false</td> <td>否</td> <td>显示投屏按钮。安卓在同层渲染下生效，支持 DLNA 协议；iOS 支持 AirPlay 和 DLNA 协议</td> <td><a href="../framework/compatibility.html">2.10.2</a></td></tr> <tr><td>picture-in-picture-mode</td> <td>string/Array</td> <td></td> <td>否</td> <td>设置小窗模式： push, pop，空字符串或通过数组形式设置多种模式（如： ["push", "pop"]）</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>picture-in-picture-show-progress</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否在小窗模式下显示播放进度</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>enable-auto-rotation</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否开启手机横屏时自动全屏，当系统设置开启自动旋转时生效</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>show-screen-lock-button</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否显示锁屏按钮，仅在全屏时显示，锁屏后控制栏的操作</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>show-snapshot-button</td> <td>boolean</td> <td>false</td> <td>否</td> <td>是否显示截屏按钮，仅在全屏时显示</td> <td><a href="../framework/compatibility.html">2.13.0</a></td></tr> <tr><td>bindplay</td> <td>eventhandle</td> <td></td> <td>否</td> <td>当开始/继续播放时触发play事件</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>bindpause</td> <td>eventhandle</td> <td></td> <td>否</td> <td>当暂停播放时触发 pause 事件</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>bindended</td> <td>eventhandle</td> <td></td> <td>否</td> <td>当播放到末尾时触发 ended 事件</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>bindtimeupdate</td> <td>eventhandle</td> <td></td> <td>否</td> <td>播放进度变化时触发，event.detail = {currentTime, duration} 。触发频率 250ms 一次</td> <td><a href="../framework/compatibility.html">1.0.0</a></td></tr> <tr><td>bindfullscreenchange</td> <td>eventhandle</td> <td></td> <td>否</td> <td>视频进入和退出全屏时触发，event.detail = {fullScreen, direction}，direction 有效值为 vertical 或 horizontal</td> <td><a href="../framework/compatibility.html">1.4.0</a></td></tr> <tr><td>bindwaiting</td> <td>eventhandle</td> <td></td> <td>否</td> <td>视频出现缓冲时触发</td> <td><a href="../framework/compatibility.html">1.7.0</a></td></tr> <tr><td>binderror</td> <td>eventhandle</td> <td></td> <td>否</td> <td>视频播放出错时触发</td> <td><a href="../framework/compatibility.html">1.7.0</a></td></tr> <tr><td>bindprogress</td> <td>eventhandle</td> <td></td> <td>否</td> <td>加载进度变化时触发，只支持一段加载。event.detail = {buffered}，百分比</td> <td><a href="../framework/compatibility.html">2.4.0</a></td></tr> <tr><td>bindloadedmetadata</td> <td>eventhandle</td> <td></td> <td>否</td> <td>视频元数据加载完成时触发。event.detail = {width, height, duration}</td> <td><a href="../framework/compatibility.html">2.7.0</a></td></tr> <tr><td>bindcontrolstoggle</td> <td>eventhandle</td> <td></td> <td>否</td> <td>切换 controls 显示隐藏时触发。event.detail = {show}</td> <td><a href="../framework/compatibility.html">2.9.5</a></td></tr> <tr><td>bindenterpictureinpicture</td> <td>eventhandler</td> <td></td> <td>否</td> <td>播放器进入小窗</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>bindleavepictureinpicture</td> <td>eventhandler</td> <td></td> <td>否</td> <td>播放器退出小窗</td> <td><a href="../framework/compatibility.html">2.11.0</a></td></tr> <tr><td>bindseekcomplete</td> <td>eventhandler</td> <td></td> <td>否</td> <td>seek 完成时触发 (position iOS 单位 s, Android 单位 ms)</td> <td><a href="../framework/compatibility.html">2.12.0</a></td></tr></tbody></table></div><p><strong>direction 的合法值</strong></p> <div class="table-wrp"><table><thead><tr><th>值</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>0</td> <td>正常竖向</td> <td></td></tr> <tr><td>90</td> <td>屏幕逆时针90度</td> <td></td></tr> <tr><td>-90</td> <td>屏幕顺时针90度</td> <td></td></tr></tbody></table></div><p><strong>object-fit 的合法值</strong></p> <div class="table-wrp"><table><thead><tr><th>值</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>contain</td> <td>包含</td> <td></td></tr> <tr><td>fill</td> <td>填充</td> <td></td></tr> <tr><td>cover</td> <td>覆盖</td> <td></td></tr></tbody></table></div><p><strong>play-btn-position 的合法值</strong></p> <div class="table-wrp"><table><thead><tr><th>值</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>bottom</td> <td>controls bar上</td> <td></td></tr> <tr><td>center</td> <td>视频中间</td> <td></td></tr></tbody></table></div><p><strong>picture-in-picture-mode 的合法值</strong></p> <div class="table-wrp"><table><thead><tr><th>值</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>[]</td> <td>取消小窗</td> <td></td></tr> <tr><td>push</td> <td>路由 push 时触发小窗</td> <td></td></tr> <tr><td>pop</td> <td>路由 pop 时触发小窗</td> <td></td></tr></tbody></table></div><h2 id="Bug-Tip"><a href="#Bug-Tip" aria-hidden="true" class="header-anchor">#</a> Bug &amp; Tip</h2> <ol><li><code>tip</code>：`<a href="video.html">video</a> 默认宽度 300px、高度 225px，可通过 wxss 设置宽高。</li> <li><code>tip</code>：从 2.4.0 起 video 支持同层渲染，更多请参考<a href="native-component.html#%E5%8E%9F%E7%94%9F%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E9%99%90%E5%88%B6">原生组件使用限制</a></li></ol> <h4 id="支持的格式"><a href="#支持的格式" aria-hidden="true" class="header-anchor">#</a> 支持的格式</h4> <div class="table-wrp"><table><thead><tr><th>格式</th> <th>iOS</th> <th>Android</th></tr></thead> <tbody><tr><td>mp4</td> <td>√</td> <td>√</td></tr> <tr><td>mov</td> <td>√</td> <td>x</td></tr> <tr><td>m4v</td> <td>√</td> <td>x</td></tr> <tr><td>3gp</td> <td>√</td> <td>√</td></tr> <tr><td>avi</td> <td>√</td> <td>x</td></tr> <tr><td>m3u8</td> <td>√</td> <td>√</td></tr> <tr><td>webm</td> <td>x</td> <td>√</td></tr></tbody></table></div><h4 id="支持的编码格式"><a href="#支持的编码格式" aria-hidden="true" class="header-anchor">#</a> 支持的编码格式</h4> <div class="table-wrp"><table><thead><tr><th>格式</th> <th>iOS</th> <th>Android</th></tr></thead> <tbody><tr><td>H.264</td> <td>√</td> <td>√</td></tr> <tr><td>HEVC</td> <td>√</td> <td>√</td></tr> <tr><td>MPEG-4</td> <td>√</td> <td>√</td></tr> <tr><td>VP9</td> <td>x</td> <td>√</td></tr></tbody></table></div><h4 id="小窗特性说明"><a href="#小窗特性说明" aria-hidden="true" class="header-anchor">#</a> 小窗特性说明</h4> <p>video 小窗支持以下三种触发模式（在组件上设置 picture-in-picture-mode 属性）：</p> <ol><li><p>push 模式，即从当前页跳转至下一页时出现小窗（页面栈push）</p></li> <li><p>pop 模式，即离开当前页面时触发（页面栈pop）</p></li> <li><p>以上两种路由行为均触发小窗</p></li></ol> <p>此外，小窗还支持以下特性：</p> <ul><li><p>小窗容器尺寸会根据原组件尺寸自动判断</p></li> <li><p>点击小窗，用户会被导航回小窗对应的播放器页面</p></li> <li><p>小窗出现后，用户可点击小窗右上角的关闭按钮或调用 context.exitPictureInPicture() 接口关闭小窗</p></li></ul> <p>当播放器进入小窗模式后，播放器所在页面处于 hide 状态(触发 onHide 生命周期)，该页面不会被销毁。当小窗被关闭时，播放器所在页面会被 unload (触发 onUnload 生命周期)。</p> <h2 id="示例代码"><a href="#示例代码" aria-hidden="true" class="header-anchor">#</a> 示例代码</h2> <p><a href="https://developers.weixin.qq.com/s/X5V6Xmmk6xYB" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="wrap-mp-code"><iframe src="https://developers.weixin.qq.com/xcode/source/mp_video?tabs=index/index.js,index/index.wxml" type="text/html" height="669" width="100%" frameborder="0" class="wrap-mp-code-iframe"></iframe></div></div></div> <!---->    


</body></html>