<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>临时素材接口</title>
  <link rel="stylesheet" href="../../style.css" />
  <link rel="stylesheet" href="../../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="临时素材接口">临时素材接口</h2>
<h3 id="获取临时素材">获取临时素材</h3>
<p>小程序可以使用本接口获取客服消息内的临时素材（即下载临时的多媒体文件）。目前小程序仅支持下载图片文件。</p>
<h4 id="接口调用请求说明">接口调用请求说明</h4>
<p>HTTP 请求方式: GET，HTTPS 调用</p>
<pre><code>https://api.weixin.qq.com/cgi-bin/media/get?access_token=ACCESS_TOKEN&media_id=MEDIA_ID
</code></pre><p>请求示例（示例为通过curl命令获取多媒体文件）</p>
<pre><code>curl -I -G "https://api.weixin.qq.com/cgi-bin/media/get?access_token=ACCESS_TOKEN&media_id=MEDIA_ID"
</code></pre><h4 id="参数说明">参数说明</h4>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">access_token</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td style="text-align:left">media_id</td>
<td>是</td>
<td>媒体文件ID</td>
</tr>
</tbody>
</table>
<h4 id="返回说明">返回说明</h4>
<p>正确情况下的返回 HTTP 头如下：</p>
<pre><code>HTTP/1.1 200 OK
Connection: close
Content-Type: image/jpeg 
Content-disposition: attachment; filename="MEDIA_ID.jpg"
Date: Sun, 06 Jan 2013 10:20:18 GMT
Cache-Control: no-cache, must-revalidate
Content-Length: 339721
curl -G "https://api.weixin.qq.com/cgi-bin/media/get?access_token=ACCESS_TOKEN&media_id=MEDIA_ID"
</code></pre><p>如果返回的是视频消息素材，则内容如下：</p>
<pre><code class="lang-json">{
 <span class="hljs-string">"video_url"</span>:DOWN_URL
}
</code></pre>
<p>错误情况下的返回JSON数据包示例如下（示例为无效媒体ID错误）：</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"errcode"</span>:<span class="hljs-number">40007</span>,
  <span class="hljs-string">"errmsg"</span>:<span class="hljs-string">"invalid media_id"</span>
}
</code></pre>
<h3 id="新增临时素材">新增临时素材</h3>
<p>小程序可以使用本接口把媒体文件（目前仅支持图片）上传到微信服务器，用户发送客服消息或被动回复用户消息。</p>
<h4 id="接口调用请求说明">接口调用请求说明</h4>
<p>HTTP 请求方式：POST/FORM，HTTPS 调用</p>
<pre><code>https://api.weixin.qq.com/cgi-bin/media/upload?access_token=ACCESS_TOKEN&type=TYPE
</code></pre><p>调用示例（使用curl命令，用FORM表单方式上传一个多媒体文件）：</p>
<pre><code>curl -F media=@test.jpg "https://api.weixin.qq.com/cgi-bin/media/upload?access_token=ACCESS_TOKEN&type=TYPE"
</code></pre><h4 id="参数说明">参数说明</h4>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th>是否必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">access_token</td>
<td>是</td>
<td>调用接口凭证</td>
</tr>
<tr>
<td style="text-align:left">type</td>
<td>是</td>
<td>image</td>
</tr>
<tr>
<td style="text-align:left">media</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody>
</table>
<h4 id="返回说明">返回说明</h4>
<p>正确情况下的返回 JSON 数据包结果如下：</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"type"</span>:<span class="hljs-string">"TYPE"</span>,
  <span class="hljs-string">"media_id"</span>:<span class="hljs-string">"MEDIA_ID"</span>,
  <span class="hljs-string">"created_at"</span>:<span class="hljs-number">123456789</span>
}
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">type</td>
<td>image</td>
</tr>
<tr>
<td style="text-align:left">media_id</td>
<td>媒体文件上传后，获取标识</td>
</tr>
<tr>
<td style="text-align:left">created_at</td>
<td>媒体文件上传时间戳</td>
</tr>
</tbody>
</table>
<p>错误情况下的返回JSON数据包示例如下（示例为无效媒体类型错误）：</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"errcode"</span>:<span class="hljs-number">40004</span>,
  <span class="hljs-string">"errmsg"</span>:<span class="hljs-string">"invalid media type"</span>
}
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
