<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>MapContext</title>
  <link rel="stylesheet" href="../../../../../../../style.css" />
  <link rel="stylesheet" href="../../../../../../../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
   <div id="docContent"><div class="content custom"><h1 id="MapContext"><a href="#MapContext" aria-hidden="true" class="header-anchor">#</a> MapContext</h1> <p>MapContext 实例，可通过 <a href="wx.createMapContext.html">wx.createMapContext</a> 获取。</p> <p><a href="MapContext.html">MapContext</a> 通过 <code>id</code> 跟一个 <a href="../../../component/map.html">map</a> 组件绑定，操作对应的 <a href="../../../component/map.html">map</a> 组件。</p> <h2 id="方法"><a href="#方法" aria-hidden="true" class="header-anchor">#</a> 方法</h2> <h3 id="MapContext-getCenterLocation"><a href="#MapContext-getCenterLocation" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.getCenterLocation.html">MapContext.getCenterLocation()</a></h3> <p>获取当前地图中心的经纬度。返回的是 gcj02 坐标系，可以用于 <a href="../../location/wx.openLocation.html">wx.openLocation()</a></p> <h3 id="MapContext-moveToLocation-Object-object"><a href="#MapContext-moveToLocation-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.moveToLocation.html">MapContext.moveToLocation(Object object)</a></h3> <p>将地图中心移置当前定位点，此时需设置地图组件 show-location 为true。<a href="../../../framework/compatibility.html">2.8.0</a> 起支持将地图中心移动到指定位置。</p> <h3 id="MapContext-translateMarker-Object-object"><a href="#MapContext-translateMarker-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.translateMarker.html">MapContext.translateMarker(Object object)</a></h3> <p>平移marker，带动画。</p> <h3 id="MapContext-moveAlong-Object-object"><a href="#MapContext-moveAlong-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.moveAlong.html">MapContext.moveAlong(Object object)</a></h3> <p>沿指定路径移动 <code>marker</code>，用于轨迹回放等场景。动画完成时触发回调事件，若动画进行中，对同一 <code>marker</code> 再次调用 <code>moveAlong</code> 方法，前一次的动画将被打断。</p> <h3 id="MapContext-includePoints-Object-object"><a href="#MapContext-includePoints-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.includePoints.html">MapContext.includePoints(Object object)</a></h3> <p>缩放视野展示所有经纬度</p> <h3 id="MapContext-getRegion"><a href="#MapContext-getRegion" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.getRegion.html">MapContext.getRegion()</a></h3> <p>获取当前地图的视野范围</p> <h3 id="MapContext-getRotate"><a href="#MapContext-getRotate" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.getRotate.html">MapContext.getRotate()</a></h3> <p>获取当前地图的旋转角</p> <h3 id="MapContext-getSkew"><a href="#MapContext-getSkew" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.getSkew.html">MapContext.getSkew()</a></h3> <p>获取当前地图的倾斜角</p> <h3 id="MapContext-getScale"><a href="#MapContext-getScale" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.getScale.html">MapContext.getScale()</a></h3> <p>获取当前地图的缩放级别</p> <h3 id="MapContext-setCenterOffset-Object-object"><a href="#MapContext-setCenterOffset-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.setCenterOffset.html">MapContext.setCenterOffset(Object object)</a></h3> <p>设置地图中心点偏移，向后向下为增长，屏幕比例范围(0.25~0.75)，默认偏移为[0.5, 0.5]</p> <h3 id="MapContext-removeCustomLayer-Object-object"><a href="#MapContext-removeCustomLayer-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.removeCustomLayer.html">MapContext.removeCustomLayer(Object object)</a></h3> <p>移除个性化图层。</p> <h3 id="MapContext-addCustomLayer-Object-object"><a href="#MapContext-addCustomLayer-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.addCustomLayer.html">MapContext.addCustomLayer(Object object)</a></h3> <p>添加个性化图层。</p> <h3 id="MapContext-addGroundOverlay-Object-object"><a href="#MapContext-addGroundOverlay-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.addGroundOverlay.html">MapContext.addGroundOverlay(Object object)</a></h3> <p>创建自定义图片图层，图片会随着地图缩放而缩放。</p> <h3 id="MapContext-updateGroundOverlay-Object-object"><a href="#MapContext-updateGroundOverlay-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.updateGroundOverlay.html">MapContext.updateGroundOverlay(Object object)</a></h3> <p>更新自定义图片图层。</p> <h3 id="MapContext-removeGroundOverlay-Object-object"><a href="#MapContext-removeGroundOverlay-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.removeGroundOverlay.html">MapContext.removeGroundOverlay(Object object)</a></h3> <p>移除自定义图片图层。</p> <h3 id="MapContext-toScreenLocation-Object-object"><a href="#MapContext-toScreenLocation-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.toScreenLocation.html">MapContext.toScreenLocation(Object object)</a></h3> <p>获取经纬度对应的屏幕坐标，坐标原点为地图左上角。</p> <h3 id="MapContext-fromScreenLocation-Object-object"><a href="#MapContext-fromScreenLocation-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.fromScreenLocation.html">MapContext.fromScreenLocation(Object object)</a></h3> <p>获取屏幕上的点对应的经纬度，坐标原点为地图左上角。</p> <h3 id="MapContext-openMapApp-Object-object"><a href="#MapContext-openMapApp-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.openMapApp.html">MapContext.openMapApp(Object object)</a></h3> <p>拉起地图APP选择导航。</p> <h3 id="MapContext-addMarkers-Object-object"><a href="#MapContext-addMarkers-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.addMarkers.html">MapContext.addMarkers(Object object)</a></h3> <p>添加 marker。</p> <h3 id="MapContext-removeMarkers-Object-object"><a href="#MapContext-removeMarkers-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.removeMarkers.html">MapContext.removeMarkers(Object object)</a></h3> <p>移除 marker。</p> <h3 id="MapContext-initMarkerCluster-Object-object"><a href="#MapContext-initMarkerCluster-Object-object" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.initMarkerCluster.html">MapContext.initMarkerCluster(Object object)</a></h3> <p>初始化点聚合的配置，未调用时采用默认配置。</p> <h3 id="MapContext-on-string-event-Object-detail"><a href="#MapContext-on-string-event-Object-detail" aria-hidden="true" class="header-anchor">#</a> <a href="MapContext.on.html">MapContext.on(string event, Object detail)</a></h3> <p>监听地图事件。</p> <h3 id="markerClusterCreate"><a href="#markerClusterCreate" aria-hidden="true" class="header-anchor">#</a> markerClusterCreate</h3> <p>缩放或拖动导致新的聚合簇产生时触发，仅返回新创建的聚合簇信息。</p> <h4 id="返回参数"><a href="#返回参数" aria-hidden="true" class="header-anchor">#</a> 返回参数</h4> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>clusters</td> <td><code>Array&amp;lt;ClusterInfo&amp;gt;</code></td> <td>聚合簇数据</td></tr></tbody></table></div><h3 id="markerClusterClick"><a href="#markerClusterClick" aria-hidden="true" class="header-anchor">#</a> markerClusterClick</h3> <p>聚合簇的点击事件。</p> <h4 id="返回参数-2"><a href="#返回参数-2" aria-hidden="true" class="header-anchor">#</a> 返回参数</h4> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>cluster</td> <td>ClusterInfo</td> <td>聚合簇</td></tr></tbody></table></div><h4 id="ClusterInfo-结构"><a href="#ClusterInfo-结构" aria-hidden="true" class="header-anchor">#</a> ClusterInfo 结构</h4> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>clusterId</td> <td>Number</td> <td>聚合簇的 id</td></tr> <tr><td>center</td> <td>LatLng</td> <td>聚合簇的坐标</td></tr> <tr><td>markerIds</td> <td><code>Array&amp;lt;Number&amp;gt;</code></td> <td>该聚合簇内的点标记数据数组</td></tr></tbody></table></div><h2 id="示例代码"><a href="#示例代码" aria-hidden="true" class="header-anchor">#</a> 示例代码</h2> <p><a href="https://developers.weixin.qq.com/s/3uVxpmmT6wY9" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- map.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myMap<span class="token punctuation">"</span></span> <span class="token attr-name">show-location</span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getCenterLocation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>获取位置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>moveToLocation<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>移动位置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translateMarker<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>移动标注<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>includePoints<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>缩放视野展示所有经纬度<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// map.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onReady</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用 wx.createMapContext 获取 map 上下文</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapCtx <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createMapContext</span><span class="token punctuation">(</span><span class="token string">'myMap'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getCenterLocation</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapCtx<span class="token punctuation">.</span><span class="token function">getCenterLocation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">moveToLocation</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapCtx<span class="token punctuation">.</span><span class="token function">moveToLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">translateMarker</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapCtx<span class="token punctuation">.</span><span class="token function">translateMarker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      markerId<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      autoRotate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      duration<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      destination<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        latitude<span class="token punctuation">:</span><span class="token number">23.10229</span><span class="token punctuation">,</span>
        longitude<span class="token punctuation">:</span><span class="token number">113.3345211</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">animationEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'animation end'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">includePoints</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mapCtx<span class="token punctuation">.</span><span class="token function">includePoints</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      padding<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      points<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        latitude<span class="token punctuation">:</span><span class="token number">23.10229</span><span class="token punctuation">,</span>
        longitude<span class="token punctuation">:</span><span class="token number">113.3345211</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        latitude<span class="token punctuation">:</span><span class="token number">23.00229</span><span class="token punctuation">,</span>
        longitude<span class="token punctuation">:</span><span class="token number">113.3345211</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div></div> <!---->    
</body>
</html>
