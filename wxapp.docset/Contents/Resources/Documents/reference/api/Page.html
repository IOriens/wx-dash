<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Page(Object object)</title>
  <link rel="stylesheet" href="../../../../../../style.css" />
  <link rel="stylesheet" href="../../../../../../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
   <div id="docContent"><div class="content custom"><h3 id="Page-Object-object"><a href="#Page-Object-object" aria-hidden="true" class="header-anchor">#</a> Page(Object object)</h3> <p>注册小程序中的一个页面。接受一个 <code>Object</code> 类型参数，其指定页面的初始数据、生命周期回调、事件处理函数等。</p> <h4 id="参数"><a href="#参数" aria-hidden="true" class="header-anchor">#</a> 参数</h4> <h5 id="Object-object"><a href="#Object-object" aria-hidden="true" class="header-anchor">#</a> Object object</h5> <div class="table-wrp"><table><thead><tr><th>属性</th> <th>类型</th> <th>默认值</th> <th>必填</th> <th>说明</th></tr></thead> <tbody><tr><td><a href="#data">data</a></td> <td>Object</td> <td></td> <td></td> <td>页面的初始数据</td></tr> <tr><td>options</td> <td>Object</td> <td></td> <td></td> <td>页面的组件选项，同 <a href="Component.html"><code>Component</code> 构造器</a> 中的 <code>options</code> ，需要基础库版本 <a href="../../framework/compatibility.html">2.10.1</a></td></tr> <tr><td><a href="#onLoad-Object-query">onLoad</a></td> <td>function</td> <td></td> <td></td> <td>生命周期回调—监听页面加载</td></tr> <tr><td><a href="#onShow">onShow</a></td> <td>function</td> <td></td> <td></td> <td>生命周期回调—监听页面显示</td></tr> <tr><td><a href="#onReady">onReady</a></td> <td>function</td> <td></td> <td></td> <td>生命周期回调—监听页面初次渲染完成</td></tr> <tr><td><a href="#onHide">onHide</a></td> <td>function</td> <td></td> <td></td> <td>生命周期回调—监听页面隐藏</td></tr> <tr><td><a href="#onUnload">onUnload</a></td> <td>function</td> <td></td> <td></td> <td>生命周期回调—监听页面卸载</td></tr> <tr><td><a href="#onPullDownRefresh">onPullDownRefresh</a></td> <td>function</td> <td></td> <td></td> <td>监听用户下拉动作</td></tr> <tr><td><a href="#onReachBottom">onReachBottom</a></td> <td>function</td> <td></td> <td></td> <td>页面上拉触底事件的处理函数</td></tr> <tr><td><a href="#onShareAppMessage-Object-object">onShareAppMessage</a></td> <td>function</td> <td></td> <td></td> <td>用户点击右上角转发</td></tr> <tr><td><a href="#onShareTimeline">onShareTimeline</a></td> <td>function</td> <td></td> <td></td> <td>用户点击右上角转发到朋友圈</td></tr> <tr><td><a href="#onAddToFavorites-Object-object">onAddToFavorites</a></td> <td>function</td> <td></td> <td></td> <td>用户点击右上角收藏</td></tr> <tr><td><a href="#onPageScroll-Object-object">onPageScroll</a></td> <td>function</td> <td></td> <td></td> <td>页面滚动触发事件的处理函数</td></tr> <tr><td><a href="#onResize-Object-object">onResize</a></td> <td>function</td> <td></td> <td></td> <td>页面尺寸改变时触发，详见 <a href="../../framework/view/resizable.html#%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E5%90%AF%E7%94%A8%E5%B1%8F%E5%B9%95%E6%97%8B%E8%BD%AC%E6%94%AF%E6%8C%81">响应显示区域变化</a></td></tr> <tr><td><a href="#onTabItemTap-Object-object">onTabItemTap</a></td> <td>function</td> <td></td> <td></td> <td>当前是 tab 页时，点击 tab 时触发</td></tr> <tr><td>其他</td> <td>any</td> <td></td> <td></td> <td>开发者可以添加任意的函数或数据到 <code>Object</code> 参数中，在页面的函数中用 <code>this</code> 可以访问</td></tr></tbody></table></div><h4 id="示例代码"><a href="#示例代码" aria-hidden="true" class="header-anchor">#</a> 示例代码</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">:</span> <span class="token string">"This is page data."</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onLoad</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do some initialize when page load.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onShow</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page show.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onReady</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page ready.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onHide</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page hide.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onUnload</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page close.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when pull down.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onReachBottom</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page reach bottom.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return custom share data when user share.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onPageScroll</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page scroll</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onResize</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page resize</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onTabItemTap</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>pagePath<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// Event handler.</span>
  <span class="token function-variable function">viewTap</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      text<span class="token punctuation">:</span> <span class="token string">'Set some data for updating view.'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this is setData callback</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  customData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    hi<span class="token punctuation">:</span> <span class="token string">'MINA'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="data"><a href="#data" aria-hidden="true" class="header-anchor">#</a> data</h4> <p><code>data</code> 是页面第一次渲染使用的<strong>初始数据</strong>。</p> <p>页面加载时，<code>data</code> 将会以<code>JSON</code>字符串的形式由逻辑层传至渲染层，因此<code>data</code>中的数据必须是可以转成<code>JSON</code>的类型：字符串，数字，布尔值，对象，数组。</p> <p>渲染层可以通过 <a href="../../framework/view/wxml/index.html">WXML</a> 对数据进行绑定。</p> <p><strong>示例代码：</strong></p> <p><a href="https://developers.weixin.qq.com/s/2PeBsKmn6EZ9" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{array[0].msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">:</span> <span class="token string">'init data'</span><span class="token punctuation">,</span>
    array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>msg<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="生命周期回调函数"><a href="#生命周期回调函数" aria-hidden="true" class="header-anchor">#</a> 生命周期回调函数</h3> <p>生命周期的触发以及页面的路由方式<a href="../../framework/app-service/route.html">详见</a></p> <h4 id="onLoad-Object-query"><a href="#onLoad-Object-query" aria-hidden="true" class="header-anchor">#</a> onLoad(Object query)</h4> <p>页面加载时触发。一个页面只会调用一次，可以在 onLoad 的参数中获取打开当前页面路径中的参数。</p> <p><strong>参数：</strong></p> <div class="table-wrp"><table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>query</td> <td>Object</td> <td>打开当前页面路径中的参数</td></tr></tbody></table></div><h4 id="onShow"><a href="#onShow" aria-hidden="true" class="header-anchor">#</a> onShow()</h4> <p>页面显示/切入前台时触发。</p> <h4 id="onReady"><a href="#onReady" aria-hidden="true" class="header-anchor">#</a> onReady()</h4> <p>页面初次渲染完成时触发。一个页面只会调用一次，代表页面已经准备妥当，可以和视图层进行交互。</p> <p>注意：对界面内容进行设置的 API 如<a href="../../api/ui/navigation-bar/wx.setNavigationBarTitle.html">wx.setNavigationBarTitle</a>，请在<code>onReady</code>之后进行。详见<a href="../../framework/app-service/page-life-cycle.html">生命周期</a></p> <h4 id="onHide"><a href="#onHide" aria-hidden="true" class="header-anchor">#</a> onHide()</h4> <p>页面隐藏/切入后台时触发。 如 <a href="../../api/route/wx.navigateTo.html">wx.navigateTo</a> 或底部 <code>tab</code> 切换到其他页面，小程序切入后台等。</p> <h4 id="onUnload"><a href="#onUnload" aria-hidden="true" class="header-anchor">#</a> onUnload()</h4> <p>页面卸载时触发。如<a href="../../api/route/wx.redirectTo.html">wx.redirectTo</a>或<a href="../../api/route/wx.navigateBack.html">wx.navigateBack</a>到其他页面时。</p> <h3 id="页面事件处理函数"><a href="#页面事件处理函数" aria-hidden="true" class="header-anchor">#</a> 页面事件处理函数</h3> <h4 id="onPullDownRefresh"><a href="#onPullDownRefresh" aria-hidden="true" class="header-anchor">#</a> onPullDownRefresh()</h4> <p>监听用户下拉刷新事件。</p> <ul><li>需要在<code>app.json</code>的<a href="../configuration/app.html#window"><code>window</code></a>选项中或<a href="../configuration/page.html">页面配置</a>中开启<code>enablePullDownRefresh</code>。</li> <li>可以通过<a href="../../api/ui/pull-down-refresh/wx.startPullDownRefresh.html">wx.startPullDownRefresh</a>触发下拉刷新，调用后触发下拉刷新动画，效果与用户手动下拉刷新一致。</li> <li>当处理完数据刷新后，<a href="../../api/ui/pull-down-refresh/wx.stopPullDownRefresh.html">wx.stopPullDownRefresh</a>可以停止当前页面的下拉刷新。</li></ul> <h4 id="onReachBottom"><a href="#onReachBottom" aria-hidden="true" class="header-anchor">#</a> onReachBottom()</h4> <p>监听用户上拉触底事件。</p> <ul><li>可以在<code>app.json</code>的<a href="../configuration/app.html#window"><code>window</code></a>选项中或<a href="../configuration/page.html">页面配置</a>中设置触发距离<code>onReachBottomDistance</code>。</li> <li>在触发距离内滑动期间，本事件只会被触发一次。</li></ul> <h4 id="onPageScroll-Object-object"><a href="#onPageScroll-Object-object" aria-hidden="true" class="header-anchor">#</a> onPageScroll(Object object)</h4> <p>监听用户滑动页面事件。</p> <p><strong>参数 Object object</strong>:</p> <div class="table-wrp"><table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>scrollTop</td> <td>Number</td> <td>页面在垂直方向已滚动的距离（单位px）</td></tr></tbody></table></div><p><strong>注意：请只在需要的时候才在 page 中定义此方法，不要定义空方法。以减少不必要的事件派发对渲染层-逻辑层通信的影响。</strong> <strong>注意：请避免在 onPageScroll 中过于频繁的执行 <code>setData</code> 等引起<a href="../../framework/performance/tips.html">逻辑层-渲染层通信</a>的操作。尤其是每次传输大量数据，会影响通信耗时。</strong></p> <h4 id="onAddToFavorites-Object-object"><a href="#onAddToFavorites-Object-object" aria-hidden="true" class="header-anchor">#</a> onAddToFavorites(Object object)</h4> <blockquote><p>本接口为 Beta 版本，安卓 7.0.15 版本起支持，暂只在安卓平台支持</p></blockquote> <p>监听用户点击右上角菜单“收藏”按钮的行为，并自定义收藏内容。</p> <p><strong>参数 Object object</strong>:</p> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>webViewUrl</td> <td>String</td> <td>页面中包含<a href="../../component/web-view.html">web-view</a>组件时，返回当前<a href="../../component/web-view.html">web-view</a>的url</td></tr></tbody></table></div><p>此事件处理函数需要 return 一个 Object，用于自定义收藏内容：</p> <div class="table-wrp"><table><thead><tr><th>字段</th> <th>说明</th> <th>默认值</th></tr></thead> <tbody><tr><td>title</td> <td>自定义标题</td> <td>页面标题或账号名称</td></tr> <tr><td>imageUrl</td> <td>自定义图片，显示图片长宽比为 1：1</td> <td>页面截图</td></tr> <tr><td>query</td> <td>自定义query字段</td> <td>当前页面的query</td></tr></tbody></table></div><p><strong>示例代码</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onAddToFavorites</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// webview 页面返回 webViewUrl</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'webViewUrl: '</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>webViewUrl<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'自定义标题'</span><span class="token punctuation">,</span>
      imageUrl<span class="token punctuation">:</span> <span class="token string">'http://demo.png'</span><span class="token punctuation">,</span>
      query<span class="token punctuation">:</span> <span class="token string">'name=xxx&amp;age=xxx'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="onShareAppMessage-Object-object"><a href="#onShareAppMessage-Object-object" aria-hidden="true" class="header-anchor">#</a> onShareAppMessage(Object object)</h4> <p>监听用户点击页面内转发按钮（<a href="../../component/button.html">button</a> 组件 <code>open-type="share"</code>）或右上角菜单“转发”按钮的行为，并自定义转发内容。</p> <p><strong>注意：只有定义了此事件处理函数，右上角菜单才会显示“转发”按钮</strong></p> <p><strong>参数 Object object</strong>:</p> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>from</td> <td>String</td> <td>转发事件来源。<br><code>button</code>：页面内转发按钮；<br><code>menu</code>：右上角转发菜单</td> <td><a href="../../framework/compatibility.html">1.2.4</a></td></tr> <tr><td>target</td> <td>Object</td> <td>如果 <code>from</code> 值是 <code>button</code>，则 <code>target</code> 是触发这次转发事件的 <code>button</code>，否则为 <code>undefined</code></td> <td><a href="../../framework/compatibility.html">1.2.4</a></td></tr> <tr><td>webViewUrl</td> <td>String</td> <td>页面中包含<a href="../../component/web-view.html">web-view</a>组件时，返回当前<a href="../../component/web-view.html">web-view</a>的url</td> <td><a href="../../framework/compatibility.html">1.6.4</a></td></tr></tbody></table></div><p>此事件处理函数需要 return 一个 Object，用于自定义转发内容，返回内容如下：</p> <p><strong>自定义转发内容</strong>
基础库 <a href="../../framework/compatibility.html">2.8.1</a> 起，分享图支持云图片。</p> <div class="table-wrp"><table><thead><tr><th>字段</th> <th>说明</th> <th>默认值</th> <th>最低版本</th></tr></thead> <tbody><tr><td>title</td> <td>转发标题</td> <td>当前小程序名称</td> <td></td></tr> <tr><td>path</td> <td>转发路径</td> <td>当前页面 path ，必须是以 / 开头的完整路径</td> <td></td></tr> <tr><td>imageUrl</td> <td>自定义图片路径，可以是本地文件路径、代码包文件路径或者网络图片路径。支持PNG及JPG。显示图片长宽比是 5:4。</td> <td>使用默认截图</td> <td><a href="../../framework/compatibility.html">1.5.0</a></td></tr></tbody></table></div><p><strong>示例代码</strong></p> <p><a href="https://developers.weixin.qq.com/s/mffqUKmr6fZU" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token string">'button'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 来自页面内转发按钮</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'自定义转发标题'</span><span class="token punctuation">,</span>
      path<span class="token punctuation">:</span> <span class="token string">'/page/user?id=123'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="onShareTimeline"><a href="#onShareTimeline" aria-hidden="true" class="header-anchor">#</a> onShareTimeline()</h4> <blockquote><p>基础库 2.11.3 开始支持，低版本需做<a href="../../framework/compatibility.html">兼容处理</a>。</p></blockquote> <blockquote><p>本接口为 Beta 版本，暂只在 Android 平台支持，详见<a href="/miniprogram/dev/framework/open-ability/share-timeline.html">分享到朋友圈 (Beta)</a></p></blockquote> <p>监听右上角菜单“分享到朋友圈”按钮的行为，并自定义分享内容。</p> <p><strong>注意：只有定义了此事件处理函数，右上角菜单才会显示“分享到朋友圈”按钮</strong></p> <p><strong>自定义转发内容</strong></p> <p>事件处理函数返回一个 Object，用于自定义分享内容，不支持自定义页面路径，返回内容如下：</p> <div class="table-wrp"><table><thead><tr><th>字段</th> <th>说明</th> <th>默认值</th> <th>最低版本</th></tr></thead> <tbody><tr><td>title</td> <td>自定义标题，即朋友圈列表页上显示的标题</td> <td>当前小程序名称</td> <td></td></tr> <tr><td>query</td> <td>自定义页面路径中携带的参数，如 path?a=1&amp;b=2 的 “?” 后面部分</td> <td>当前页面路径携带的参数</td> <td></td></tr> <tr><td>imageUrl</td> <td>自定义图片路径，可以是本地文件或者网络图片。支持 PNG 及 JPG，显示图片长宽比是 1:1。</td> <td>默认使用小程序 Logo</td> <td></td></tr></tbody></table></div><h4 id="onResize-Object-object"><a href="#onResize-Object-object" aria-hidden="true" class="header-anchor">#</a> onResize(Object object)</h4> <blockquote><p>基础库 2.4.0 开始支持，低版本需做<a href="../../framework/compatibility.html">兼容处理</a>。</p></blockquote> <p>小程序屏幕旋转时触发。详见 <a href="../../framework/view/resizable.html#%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E5%90%AF%E7%94%A8%E5%B1%8F%E5%B9%95%E6%97%8B%E8%BD%AC%E6%94%AF%E6%8C%81">响应显示区域变化</a></p> <h4 id="onTabItemTap-Object-object"><a href="#onTabItemTap-Object-object" aria-hidden="true" class="header-anchor">#</a> onTabItemTap(Object object)</h4> <blockquote><p>基础库 1.9.0 开始支持，低版本需做<a href="../../framework/compatibility.html">兼容处理</a>。</p></blockquote> <p>点击 tab 时触发</p> <p><strong>Object 参数说明：</strong></p> <div class="table-wrp"><table><thead><tr><th>参数</th> <th>类型</th> <th>说明</th> <th>最低版本</th></tr></thead> <tbody><tr><td>index</td> <td>String</td> <td>被点击tabItem的序号，从0开始</td> <td><a href="../../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>pagePath</td> <td>String</td> <td>被点击tabItem的页面路径</td> <td><a href="../../framework/compatibility.html">1.9.0</a></td></tr> <tr><td>text</td> <td>String</td> <td>被点击tabItem的按钮文字</td> <td><a href="../../framework/compatibility.html">1.9.0</a></td></tr></tbody></table></div><p><strong>示例代码：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onTabItemTap</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>pagePath<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="组件事件处理函数"><a href="#组件事件处理函数" aria-hidden="true" class="header-anchor">#</a> 组件事件处理函数</h3> <p><code>Page</code> 中还可以定义组件事件处理函数。在渲染层的组件中加入<a href="../../framework/view/wxml/event.html">事件绑定</a>，当事件被触发时，就会执行 Page 中定义的事件处理函数。</p> <p><strong>示例代码：</strong></p> <p><a href="https://developers.weixin.qq.com/s/vUf6fKmX64Zn" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> click me <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">viewTap</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'view tap'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="Page-route"><a href="#Page-route" aria-hidden="true" class="header-anchor">#</a> Page.route</h3> <blockquote><p>基础库 1.2.0 开始支持，低版本需做<a href="../../framework/compatibility.html">兼容处理</a>。</p></blockquote> <p>到当前页面的路径，类型为<code>String</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onShow</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="Page-prototype-setData-Object-data-Function-callback"><a href="#Page-prototype-setData-Object-data-Function-callback" aria-hidden="true" class="header-anchor">#</a> Page.prototype.setData(Object data, Function callback)</h3> <p><code>setData</code> 函数用于将数据从逻辑层发送到视图层（异步），同时改变对应的 <code>this.data</code> 的值（同步）。</p> <h4 id="参数说明"><a href="#参数说明" aria-hidden="true" class="header-anchor">#</a> 参数说明</h4> <div class="table-wrp"><table><thead><tr><th>字段</th> <th>类型</th> <th>必填</th> <th>描述</th> <th>最低版本</th></tr></thead> <tbody><tr><td>data</td> <td>Object</td> <td>是</td> <td>这次要改变的数据</td> <td></td></tr> <tr><td>callback</td> <td>Function</td> <td>否</td> <td>setData引起的界面更新渲染完毕后的回调函数</td> <td><a href="../../framework/compatibility.html">1.5.0</a></td></tr></tbody></table></div><p><code>Object</code> 以 <code>key: value</code> 的形式表示，将 <code>this.data</code> 中的 <code>key</code> 对应的值改变成 <code>value</code>。</p> <p><strong>其中 <code>key</code> 可以以数据路径的形式给出，支持改变数组中的某一项或对象的某个属性，如 <code>array[2].message</code>，<code>a.b.c.d</code>，并且不需要在 this.data 中预先定义。</strong></p> <p><strong>注意：</strong></p> <ol><li><strong>直接修改 this.data 而不调用 this.setData 是无法改变页面的状态的，还会造成数据不一致</strong>。</li> <li>仅支持设置可 JSON 化的数据。</li> <li>单次设置的数据不能超过1024kB，请尽量避免一次设置过多的数据。</li> <li>请不要把 data 中任何一项的 value 设为 <code>undefined</code> ，否则这一项将不被设置并可能遗留一些潜在问题。</li></ol> <p><strong>示例代码：</strong></p> <p><a href="https://developers.weixin.qq.com/s/HofnzKmb6fZe" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--index.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeText<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Change normal data <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeNum<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Change normal num <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{array[0].text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeItemInArray<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Change Array data <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{object.text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>changeItemInObject<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Change Object data <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{newField.text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addNewField<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Add new data <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">:</span> <span class="token string">'init data'</span><span class="token punctuation">,</span>
    num<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>text<span class="token punctuation">:</span> <span class="token string">'init data'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    object<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      text<span class="token punctuation">:</span> <span class="token string">'init data'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">changeText</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.data.text = 'changed data' // 不要直接修改 this.data</span>
    <span class="token comment">// 应该使用 setData</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      text<span class="token punctuation">:</span> <span class="token string">'changed data'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">changeNum</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 或者，可以修改 this.data 之后马上用 setData 设置一下修改了的字段</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      num<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>num
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">changeItemInArray</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对于对象或数组字段，可以直接修改一个其下的子字段，这样做通常比修改整个对象或数组更好</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'array[0].text'</span><span class="token punctuation">:</span><span class="token string">'changed data'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">changeItemInObject</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'object.text'</span><span class="token punctuation">:</span> <span class="token string">'changed data'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addNewField</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'newField.text'</span><span class="token punctuation">:</span> <span class="token string">'new data'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="页面间通信"><a href="#页面间通信" aria-hidden="true" class="header-anchor">#</a> 页面间通信</h3> <blockquote><p>基础库 2.7.3 开始支持，低版本需做<a href="../../framework/compatibility.html">兼容处理</a>。</p></blockquote> <p>如果一个页面由另一个页面通过 <a href="../../api/route/wx.navigateTo.html"><code>wx.navigateTo</code></a> 打开，这两个页面间将建立一条数据通道：</p> <ul><li>被打开的页面可以通过 <code>this.getOpenerEventChannel()</code> 方法来获得一个 <code>EventChannel</code> 对象；</li> <li><code>wx.navigateTo</code> 的 <code>success</code> 回调中也包含一个 <code>EventChannel</code> 对象。</li></ul> <p>这两个 <code>EventChannel</code> 对象间可以使用 <code>emit</code> 和 <code>on</code> 方法相互发送、监听事件。</p> <p><a href="https://developers.weixin.qq.com/s/sYz82Kmy7Gfq" title="在开发者工具中预览效果" target="_blank" rel="noopener noreferrer">在开发者工具中预览效果<span></span></a></p></div></div> <!---->    
</body>
</html>
