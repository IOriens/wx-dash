<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>动画</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="wxcreateanimationobject">wx.createAnimation(OBJECT)</h3>
<p>创建一个动画实例<a href="#animation">animation</a>。调用实例的方法来描述动画。最后通过动画实例的<code>export</code>方法导出动画数据传递给组件的<code>animation</code>属性。</p>
<p><strong>注意: <code>export</code> 方法每次调用后会清掉之前的动画操作 </strong></p>
<p><strong>OBJECT参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>duration</td>
<td>Integer</td>
<td>否</td>
<td>400</td>
<td>动画持续时间，单位ms</td>
</tr>
<tr>
<td>timingFunction</td>
<td>String</td>
<td>否</td>
<td>"linear"</td>
<td>定义动画的效果</td>
</tr>
<tr>
<td>delay</td>
<td>Integer</td>
<td>否</td>
<td>0</td>
<td>动画延迟时间，单位 ms</td>
</tr>
<tr>
<td>transformOrigin</td>
<td>String</td>
<td>否</td>
<td>"50% 50% 0"</td>
<td>设置transform-origin</td>
</tr>
</tbody>
</table>
<p><strong> timingFunction 有效值：</strong></p>
<table>
<thead>
<tr>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>linear</td>
<td>动画从头到尾的速度是相同的</td>
</tr>
<tr>
<td>ease</td>
<td>动画以低速开始，然后加快，在结束前变慢</td>
</tr>
<tr>
<td>ease-in</td>
<td>动画以低速开始</td>
</tr>
<tr>
<td>ease-in-out</td>
<td>动画以低速开始和结束</td>
</tr>
<tr>
<td>ease-out</td>
<td>动画以低速结束</td>
</tr>
<tr>
<td>step-start</td>
<td>动画第一帧就跳至结束状态直到结束</td>
</tr>
<tr>
<td>step-end</td>
<td>动画一直保持开始状态，最后一帧跳到结束状态</td>
</tr>
</tbody>
</table>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> animation = wx.createAnimation({
  transformOrigin: <span class="hljs-string">"50% 50%"</span>,
  duration: <span class="hljs-number">1000</span>,
  timingFunction: <span class="hljs-string">"ease"</span>,
  delay: <span class="hljs-number">0</span>
})
</code></pre>
<h3 id="animation">animation</h3>
<p>动画实例可以调用以下方法来描述动画，调用结束后会返回自身，支持链式调用的写法。</p>
<p><strong> animation 对象的方法列表：</strong></p>
<p>样式：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>opacity</td>
<td>value</td>
<td>透明度，参数范围 0~1</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>color</td>
<td>颜色值</td>
</tr>
<tr>
<td>width</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
<tr>
<td>height</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
<tr>
<td>top</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
<tr>
<td>left</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
<tr>
<td>bottom</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
<tr>
<td>right</td>
<td>length</td>
<td>长度值，如果传入 Number 则默认使用 px，可传入其他自定义单位的长度值</td>
</tr>
</tbody>
</table>
<p>旋转：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>rotate</td>
<td>deg</td>
<td>deg的范围-180~180，从原点顺时针旋转一个deg角度</td>
</tr>
<tr>
<td>rotateX</td>
<td>deg</td>
<td>deg的范围-180~180，在X轴旋转一个deg角度</td>
</tr>
<tr>
<td>rotateY</td>
<td>deg</td>
<td>deg的范围-180~180，在Y轴旋转一个deg角度</td>
</tr>
<tr>
<td>rotateZ</td>
<td>deg</td>
<td>deg的范围-180~180，在Z轴旋转一个deg角度</td>
</tr>
<tr>
<td>rotate3d</td>
<td>(x,y,z,deg)</td>
<td>同<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/rotate3d" target="_blank">transform-function rotate3d</a></td>
</tr>
</tbody>
</table>
<p>缩放：</p>
<table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">scale</td>
<td>sx,[sy]</td>
<td>一个参数时，表示在X轴、Y轴同时缩放sx倍数；两个参数时表示在X轴缩放sx倍数，在Y轴缩放sy倍数</td>
</tr>
<tr>
<td style="text-align:left">scaleX</td>
<td>sx</td>
<td>在X轴缩放sx倍数</td>
</tr>
<tr>
<td style="text-align:left">scaleY</td>
<td>sy</td>
<td>在Y轴缩放sy倍数</td>
</tr>
<tr>
<td style="text-align:left">scaleZ</td>
<td>sz</td>
<td>在Z轴缩放sy倍数</td>
</tr>
<tr>
<td style="text-align:left">scale3d</td>
<td>(sx,sy,sz)</td>
<td>在X轴缩放sx倍数，在Y轴缩放sy倍数，在Z轴缩放sz倍数</td>
</tr>
</tbody>
</table>
<p>偏移：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>translate</td>
<td>tx,[ty]</td>
<td>一个参数时，表示在X轴偏移tx，单位px；两个参数时，表示在X轴偏移tx，在Y轴偏移ty，单位px。</td>
</tr>
<tr>
<td>translateX</td>
<td>tx</td>
<td>在X轴偏移tx，单位px</td>
</tr>
<tr>
<td>translateY</td>
<td>ty</td>
<td>在Y轴偏移tx，单位px</td>
</tr>
<tr>
<td>translateZ</td>
<td>tz</td>
<td>在Z轴偏移tx，单位px</td>
</tr>
<tr>
<td>translate3d</td>
<td>(tx,ty,tz)</td>
<td>在X轴偏移tx，在Y轴偏移ty，在Z轴偏移tz，单位px</td>
</tr>
</tbody>
</table>
<p>倾斜：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>skew</td>
<td>ax,[ay]</td>
<td>参数范围-180~180；一个参数时，Y轴坐标不变，X轴坐标延顺时针倾斜ax度；两个参数时，分别在X轴倾斜ax度，在Y轴倾斜ay度</td>
</tr>
<tr>
<td>skewX</td>
<td>ax</td>
<td>参数范围-180~180；Y轴坐标不变，X轴坐标延顺时针倾斜ax度</td>
</tr>
<tr>
<td>skewY</td>
<td>ay</td>
<td>参数范围-180~180；X轴坐标不变，Y轴坐标延顺时针倾斜ay度</td>
</tr>
</tbody>
</table>
<p>矩阵变形：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>matrix</td>
<td>(a,b,c,d,tx,ty)</td>
<td>同<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix" target="_blank">transform-function matrix</a></td>
</tr>
<tr>
<td>matrix3d</td>
<td></td>
<td>同<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix3d" target="_blank">transform-function matrix3d</a></td>
</tr>
</tbody>
</table>
<h3 id="动画队列">动画队列</h3>
<p>调用动画操作方法后要调用 <code>step()</code> 来表示一组动画完成，可以在一组动画中调用任意多个动画方法，一组动画中的所有动画会同时开始，一组动画完成后才会进行下一组动画。step 可以传入一个跟 <code>wx.createAnimation()</code> 一样的配置参数用于指定当前组动画的配置。</p>
<p><strong>示例：</strong></p>
<pre><code class="lang-html"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">animation</span>=<span class="hljs-string">"{{animationData}}"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background:red;height:100rpx;width:100rpx"</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span>
</code></pre>
<pre><code class="lang-javascript">Page({
  data: {
    animationData: {}
  },
  onShow: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> animation = wx.createAnimation({
      duration: <span class="hljs-number">1000</span>,
        timingFunction: <span class="hljs-string">'ease'</span>,
    })

    <span class="hljs-keyword">this</span>.animation = animation

    animation.scale(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>).rotate(<span class="hljs-number">45</span>).step()

    <span class="hljs-keyword">this</span>.setData({
      animationData:animation.export()
    })

    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      animation.translate(<span class="hljs-number">30</span>).step()
      <span class="hljs-keyword">this</span>.setData({
        animationData:animation.export()
      })
    }.bind(<span class="hljs-keyword">this</span>), <span class="hljs-number">1000</span>)
  },
  rotateAndScale: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 旋转同时放大</span>
    <span class="hljs-keyword">this</span>.animation.rotate(<span class="hljs-number">45</span>).scale(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>).step()
    <span class="hljs-keyword">this</span>.setData({
      animationData: <span class="hljs-keyword">this</span>.animation.export()
    })
  },
  rotateThenScale: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 先旋转后放大</span>
    <span class="hljs-keyword">this</span>.animation.rotate(<span class="hljs-number">45</span>).step()
    <span class="hljs-keyword">this</span>.animation.scale(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>).step()
    <span class="hljs-keyword">this</span>.setData({
      animationData: <span class="hljs-keyword">this</span>.animation.export()
    })
  },
  rotateAndScaleThenTranslate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// 先旋转同时放大，然后平移</span>
    <span class="hljs-keyword">this</span>.animation.rotate(<span class="hljs-number">45</span>).scale(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>).step()
    <span class="hljs-keyword">this</span>.animation.translate(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>).step({ duration: <span class="hljs-number">1000</span> })
    <span class="hljs-keyword">this</span>.setData({
      animationData: <span class="hljs-keyword">this</span>.animation.export()
    })
  }
})
</code></pre>
<h4 id="bug--tip">bug & tip</h4>
<ol>
<li><code>bug</code>: <code>iOS/Android</code> <code>6.3.30</code> 通过 step() 分隔动画，只有第一步动画能生效</li>
</ol>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
