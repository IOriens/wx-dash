<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>组件事件</title>
  <link rel="stylesheet" href="../../style.css" />
  <link rel="stylesheet" href="../../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="组件事件">组件事件</h1>
<p>事件系统是组件间交互的主要形式。自定义组件可以触发任意的事件，引用组件的页面可以监听这些事件。关于事件的基本概念和用法，参见 <a href="../view/wxml/event.html">事件</a> 。</p>
<p>监听自定义组件事件的方法与监听基础组件事件的方法完全一致：</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-html"><span class="hljs-comment"><!-- 当自定义组件触发“myevent”事件时，调用“onMyEvent”方法 --></span>
<span class="hljs-tag"><<span class="hljs-name">component-tag-name</span> <span class="hljs-attr">bindmyevent</span>=<span class="hljs-string">"onMyEvent"</span> /></span>
<span class="hljs-comment"><!-- 或者可以写成 --></span>
<span class="hljs-tag"><<span class="hljs-name">component-tag-name</span> <span class="hljs-attr">bind:myevent</span>=<span class="hljs-string">"onMyEvent"</span> /></span>
</code></pre>
<pre><code class="lang-js">Page({
  onMyEvent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    e.detail <span class="hljs-comment">// 自定义组件触发事件时提供的detail对象</span>
  }
})
</code></pre>
<p>自定义组件触发事件时，需要使用 <code>triggerEvent</code> 方法，指定事件名、detail对象和事件选项：</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-html"><span class="hljs-comment"><!-- 在自定义组件中 --></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"onTap"</span>></span>点击这个按钮将触发“myevent”事件<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
</code></pre>
<pre><code class="lang-js">Component({
  properties: {}
  methods: {
    onTap: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">var</span> myEventDetail = {} <span class="hljs-comment">// detail对象，提供给事件监听函数</span>
      <span class="hljs-keyword">var</span> myEventOption = {} <span class="hljs-comment">// 触发事件的选项</span>
      <span class="hljs-keyword">this</span>.triggerEvent(<span class="hljs-string">'myevent'</span>, myEventDetail, myEventOption)
    }
  }
})
</code></pre>
<p>触发事件的选项包括：</p>
<table>
<thead>
<tr>
<th>选项名</th>
<th>类型</th>
<th>是否必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bubbles</td>
<td>Boolean</td>
<td>否</td>
<td>false</td>
<td>事件是否冒泡</td>
</tr>
<tr>
<td>composed</td>
<td>Boolean</td>
<td>否</td>
<td>false</td>
<td>事件是否可以穿越组件边界，为false时，事件将只能在引用组件的节点树上触发，不进入其他任何组件内部</td>
</tr>
<tr>
<td>capturePhase</td>
<td>Boolean</td>
<td>否</td>
<td>false</td>
<td>事件是否拥有捕获阶段</td>
</tr>
</tbody>
</table>
<p>关于冒泡和捕获阶段的概念，请阅读 <a href="../view/wxml/event.html">事件</a> 章节中的相关说明。</p>
<p><strong>代码示例：</strong></p>
<pre><code class="lang-html">// 页面 page.wxml
<span class="hljs-tag"><<span class="hljs-name">another-component</span> <span class="hljs-attr">bindcustomevent</span>=<span class="hljs-string">"pageEventListener1"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">my-component</span> <span class="hljs-attr">bindcustomevent</span>=<span class="hljs-string">"pageEventListener2"</span>></span><span class="hljs-tag"></<span class="hljs-name">my-component</span>></span>
<span class="hljs-tag"></<span class="hljs-name">another-component</span>></span>
</code></pre>
<pre><code class="lang-html">// 组件 another-component.wxml
<span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">bindcustomevent</span>=<span class="hljs-string">"anotherEventListener"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">slot</span> /></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
</code></pre>
<pre><code class="lang-html">// 组件 my-component.wxml
<span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">bindcustomevent</span>=<span class="hljs-string">"myEventListener"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">slot</span> /></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// 组件 my-component.js</span>
Component({
  methods: {
    onTap: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
      <span class="hljs-keyword">this</span>.triggerEvent(<span class="hljs-string">'customevent'</span>, {}) <span class="hljs-comment">// 只会触发 pageEventListener2</span>
      <span class="hljs-keyword">this</span>.triggerEvent(<span class="hljs-string">'customevent'</span>, {}, { bubbles: <span class="hljs-literal">true</span> }) <span class="hljs-comment">// 会依次触发 pageEventListener2 、 pageEventListener1</span>
      <span class="hljs-keyword">this</span>.triggerEvent(<span class="hljs-string">'customevent'</span>, {}, { bubbles: <span class="hljs-literal">true</span>, composed: <span class="hljs-literal">true</span> }) <span class="hljs-comment">// 会依次触发 pageEventListener2 、 anotherEventListener 、 pageEventListener1</span>
    }
  }
})
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
