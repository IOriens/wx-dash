<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>录音管理</title>
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="../website.css" />
  <style type="text/css">
    body {
      padding: 1em;
    }
  </style>
</head>
<body>
  
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="wxgetrecordermanager">wx.getRecorderManager()</h3>
<blockquote>
<p>基础库 1.6.0 开始支持，低版本需做<a href="../framework/compatibility.html">兼容处理</a></p>
</blockquote>
<p>获取<strong>全局唯一</strong>的录音管理器 <code>recorderManager</code>。</p>
<h4 id="recordermanager">recorderManager</h4>
<p><strong>recorderManager 对象的方法列表：</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>options</td>
<td>开始录音</td>
</tr>
<tr>
<td>pause</td>
<td></td>
<td>暂停录音</td>
</tr>
<tr>
<td>resume</td>
<td></td>
<td>继续录音</td>
</tr>
<tr>
<td>stop</td>
<td></td>
<td>停止录音</td>
</tr>
<tr>
<td>onStart</td>
<td>callback</td>
<td>录音开始事件</td>
</tr>
<tr>
<td>onPause</td>
<td>callback</td>
<td>录音暂停事件</td>
</tr>
<tr>
<td>onStop</td>
<td>callback</td>
<td>录音停止事件，会回调文件地址</td>
</tr>
<tr>
<td>onFrameRecorded</td>
<td>callback</td>
<td>已录制完指定帧大小的文件，会回调录音分片结果数据。如果设置了 frameSize ，则会回调此事件</td>
</tr>
<tr>
<td>onError</td>
<td>callback</td>
<td>录音错误事件, 会回调错误信息</td>
</tr>
</tbody>
</table>
<p><strong>start(options) 说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>duration</td>
<td>Number</td>
<td>否</td>
<td>指定录音的时长，单位 ms ，如果传入了合法的 duration ，在到达指定的 duration 后会自动停止录音，最大值 600000（10 分钟）,默认值 60000（1 分钟）</td>
</tr>
<tr>
<td>sampleRate</td>
<td>Number</td>
<td>否</td>
<td>采样率，有效值 8000/16000/44100</td>
</tr>
<tr>
<td>numberOfChannels</td>
<td>Number</td>
<td>否</td>
<td>录音通道数，有效值 1/2</td>
</tr>
<tr>
<td>encodeBitRate</td>
<td>Number</td>
<td>否</td>
<td>编码码率，有效值见下表格</td>
</tr>
<tr>
<td>format</td>
<td>String</td>
<td>否</td>
<td>音频格式，有效值 aac/mp3</td>
</tr>
<tr>
<td>frameSize</td>
<td>Number</td>
<td>否</td>
<td>指定帧大小，单位 KB。传入 frameSize 后，每录制指定帧大小的内容后，会回调录制的文件内容，不指定则不会回调。暂仅支持 mp3 格式。</td>
</tr>
</tbody>
</table>
<p>其中，采样率和码率有一定要求，具体有效值如下：</p>
<table>
<thead>
<tr>
<th>采样率</th>
<th>编码码率</th>
</tr>
</thead>
<tbody>
<tr>
<td>8000</td>
<td>16000 ~ 48000</td>
</tr>
<tr>
<td>11025</td>
<td>16000 ~ 48000</td>
</tr>
<tr>
<td>12000</td>
<td>24000 ~ 64000</td>
</tr>
<tr>
<td>16000</td>
<td>24000 ~ 96000</td>
</tr>
<tr>
<td>22050</td>
<td>32000 ~ 128000</td>
</tr>
<tr>
<td>24000</td>
<td>32000 ~ 128000</td>
</tr>
<tr>
<td>32000</td>
<td>48000 ~ 192000</td>
</tr>
<tr>
<td>44100</td>
<td>64000 ~ 320000</td>
</tr>
<tr>
<td>48000</td>
<td>64000 ~ 320000</td>
</tr>
</tbody>
</table>
<p><strong>onStop(callback) 回调结果说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tempFilePath</td>
<td>String</td>
<td>录音文件的临时路径</td>
</tr>
</tbody>
</table>
<p><strong>onFrameRecorded(callback) 回调结果说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>frameBuffer</td>
<td>ArrayBuffer</td>
<td>录音分片结果数据</td>
</tr>
<tr>
<td>isLastFrame</td>
<td>Boolean</td>
<td>当前帧是否正常录音结束前的最后一帧</td>
</tr>
</tbody>
</table>
<p><strong>onError(callback) 回调结果说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>errMsg</td>
<td>String</td>
<td>错误信息</td>
</tr>
</tbody>
</table>
<p><strong>示例代码：</strong></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> recorderManager = wx.getRecorderManager()

recorderManager.onStart(() => {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'recorder start'</span>)
})
recorderManager.onResume(() => {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'recorder resume'</span>)
})
recorderManager.onPause(() => {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'recorder pause'</span>)
})
recorderManager.onStop((res) => {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'recorder stop'</span>, res)
  <span class="hljs-keyword">const</span> { tempFilePath } = res
})
recorderManager.onFrameRecorded((res) => {
  <span class="hljs-keyword">const</span> { frameBuffer } = res
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'frameBuffer.byteLength'</span>, frameBuffer.byteLength)
})

<span class="hljs-keyword">const</span> options = {
  duration: <span class="hljs-number">10000</span>,
  sampleRate: <span class="hljs-number">44100</span>,
  numberOfChannels: <span class="hljs-number">1</span>,
  encodeBitRate: <span class="hljs-number">192000</span>,
  format: <span class="hljs-string">'aac'</span>,
  frameSize: <span class="hljs-number">50</span>
}

recorderManager.start(options)
</code></pre>

                                
                                </section>
                            
    </div>
    
</div>

                        
</body>
</html>
